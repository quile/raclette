#!/usr/bin/env perl

use strict;
use warnings;

use Getopt::Long;

use Raclette::YTDL;

# 1. parse options

my $output = "./work";
my $input  = undef;

my $result = GetOptions(
    "output=s" => \$output,
    "input=s" => \$input, # either a youtube url or a youtube playlist URL or youtube id
);

unless ($result && $input) {
    usage();
    exit(1);
}

# 2. run youtube-dl with appropriate options

my $ytdl = Raclette::YTDL->new($input, $output)->init(); 
$result  = $ytdl->execute();

print "Output in location: ".$result->{location}."\nyoutube-dl output:\n".$result->{output}."\n\n";

# 3. foreach downloaded video:
#    3.1 Download thumbnail
#    3.2 Generate tags and splits
#    3.3 foreach split:
#        3.3.1 run ffmpeg to generate split and apply tags
#        3.3.2 run mp4art to add cover art to new split

